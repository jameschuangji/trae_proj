<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwitchColor Test Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
            background-image: linear-gradient(45deg, #f0f0f0 25%, transparent 25%), 
                              linear-gradient(-45deg, #f0f0f0 25%, transparent 25%), 
                              linear-gradient(45deg, transparent 75%, #f0f0f0 75%), 
                              linear-gradient(-45deg, transparent 75%, #f0f0f0 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        
        .test-section h2 {
            color: #666;
            margin-top: 0;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 15px 0;
        }
        
        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
        }
        
        .success-box {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
        }
        
        .test-button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-button:hover {
            background: #1976d2;
        }
        
        #debugInfo {
            background: #f5f5f5;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ SwitchColor Extension Test Page</h1>
        
        <div class="test-section">
            <h2>æµ‹è¯•è¯´æ˜</h2>
            <div class="info-box">
                <strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong>
                <ol>
                    <li>ç¡®ä¿SwitchColoræ‰©å±•å·²å®‰è£…å¹¶å¯ç”¨</li>
                    <li>ç‚¹å‡»æµè§ˆå™¨å·¥å…·æ ä¸­çš„SwitchColorå›¾æ ‡</li>
                    <li>é€‰æ‹©é¢œè‰²å¹¶ç‚¹å‡»"åˆ‡æ¢èƒŒæ™¯é¢œè‰²"æŒ‰é’®</li>
                    <li>è§‚å¯Ÿé¡µé¢èƒŒæ™¯æ˜¯å¦å‘ç”Ÿå˜åŒ–</li>
                    <li>å†æ¬¡ç‚¹å‡»æŒ‰é’®æµ‹è¯•æ¢å¤åŠŸèƒ½</li>
                </ol>
            </div>
        </div>
        
        <div class="test-section">
            <h2>å½“å‰é¡µé¢ä¿¡æ¯</h2>
            <div class="warning-box">
                <strong>åŸå§‹èƒŒæ™¯ï¼š</strong> ç°è‰²æ¸å˜å›¾æ¡ˆèƒŒæ™¯<br>
                <strong>é¡µé¢ç±»å‹ï¼š</strong> é™æ€HTMLé¡µé¢<br>
                <strong>ç›®æ ‡å…ƒç´ ï¼š</strong> body å…ƒç´ 
            </div>
        </div>
        
        <div class="test-section">
            <h2>æµ‹è¯•åŠŸèƒ½</h2>
            <button class="test-button" onclick="testExtensionState()">æ£€æŸ¥æ‰©å±•çŠ¶æ€</button>
            <button class="test-button" onclick="testBackgroundInfo()">æ˜¾ç¤ºèƒŒæ™¯ä¿¡æ¯</button>
            <button class="test-button" onclick="clearDebugInfo()">æ¸…ç©ºè°ƒè¯•ä¿¡æ¯</button>
            
            <div id="debugInfo" style="margin-top: 15px;">
ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...
            </div>
        </div>
        
        <div class="test-section">
            <h2>é¢„æœŸæµ‹è¯•ç»“æœ</h2>
            <div class="success-box">
                <strong>âœ… æˆåŠŸæ ‡å‡†ï¼š</strong>
                <ul>
                    <li>æ‰©å±•å›¾æ ‡æ­£å¸¸æ˜¾ç¤ºåœ¨å·¥å…·æ </li>
                    <li>ç‚¹å‡»å›¾æ ‡èƒ½æ‰“å¼€å¼¹å‡ºçª—å£</li>
                    <li>é¢œè‰²é€‰æ‹©å™¨å·¥ä½œæ­£å¸¸</li>
                    <li>èƒŒæ™¯åˆ‡æ¢åŠŸèƒ½æ­£å¸¸å·¥ä½œ</li>
                    <li>èƒ½å¤Ÿæ¢å¤åŸå§‹èƒŒæ™¯</li>
                    <li>çŠ¶æ€æŒ‡ç¤ºå™¨æ­£ç¡®æ›´æ–°</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // æµ‹è¯•å‡½æ•°
        function testExtensionState() {
            const debugInfo = document.getElementById('debugInfo');
            let info = '=== æ‰©å±•çŠ¶æ€æ£€æŸ¥ ===\n';
            
            // æ£€æŸ¥æ˜¯å¦æœ‰SwitchColorè°ƒè¯•å¯¹è±¡
            if (window.SwitchColorDebug) {
                info += 'âœ… SwitchColoræ‰©å±•å·²åŠ è½½\n';
                info += `çŠ¶æ€: ${window.SwitchColorDebug.state.isModified ? 'å·²ä¿®æ”¹' : 'åŸå§‹'}\n`;
                info += `å½“å‰é¢œè‰²: ${window.SwitchColorDebug.state.currentColor || 'æ— '}\n`;
                info += `ç›®æ ‡å…ƒç´ : ${window.SwitchColorDebug.state.targetElement ? window.SwitchColorDebug.state.targetElement.tagName : 'æ— '}\n`;
            } else {
                info += 'âŒ SwitchColoræ‰©å±•æœªæ£€æµ‹åˆ°\n';
                info += 'è¯·ç¡®ä¿æ‰©å±•å·²æ­£ç¡®å®‰è£…å¹¶åˆ·æ–°é¡µé¢\n';
            }
            
            info += `\né¡µé¢URL: ${window.location.href}\n`;
            info += `ç”¨æˆ·ä»£ç†: ${navigator.userAgent.substring(0, 50)}...\n`;
            
            debugInfo.textContent = info;
        }
        
        function testBackgroundInfo() {
            const debugInfo = document.getElementById('debugInfo');
            let info = '=== èƒŒæ™¯ä¿¡æ¯æ£€æŸ¥ ===\n';
            
            const body = document.body;
            const computedStyle = window.getComputedStyle(body);
            
            info += `BodyèƒŒæ™¯é¢œè‰²: ${computedStyle.backgroundColor}\n`;
            info += `BodyèƒŒæ™¯å›¾ç‰‡: ${computedStyle.backgroundImage}\n`;
            info += `BodyèƒŒæ™¯: ${computedStyle.background.substring(0, 100)}...\n`;
            
            // æ£€æŸ¥æ˜¯å¦æœ‰SwitchColorä¿®æ”¹æ ‡è®°
            if (body.classList.contains('switchcolor-modified')) {
                info += 'âœ… æ£€æµ‹åˆ°SwitchColorä¿®æ”¹æ ‡è®°\n';
            } else {
                info += 'âšª æœªæ£€æµ‹åˆ°SwitchColorä¿®æ”¹æ ‡è®°\n';
            }
            
            debugInfo.textContent = info;
        }
        
        function clearDebugInfo() {
            document.getElementById('debugInfo').textContent = 'è°ƒè¯•ä¿¡æ¯å·²æ¸…ç©º...';
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', function() {
            setTimeout(testExtensionState, 1000);
        });
        
        // ç›‘å¬èƒŒæ™¯å˜åŒ–
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                    console.log('SwitchColor Test: æ£€æµ‹åˆ°æ ·å¼å˜åŒ–', mutation.target);
                }
            });
        });
        
        observer.observe(document.body, {
            attributes: true,
            attributeFilter: ['style', 'class']
        });
    </script>
</body>
</html>
